 The purpose of this task is to process and transform security-related data retrieved from AWS Security Hub by control name. The task processes the findings, organizes them based on specific security controls, and outputs the data in a structured format, such as JSON. This structured output enables easier analysis and integration into compliance checks, helping security teams take informed actions based on control-specific findings

### **InputsAndOutputsStructure**:

1. Inputs:
    - SecurityHubFindingsFile: [MANDATORY] <<MINIO_FILE_PATH>>
    - ControlName: [MANDATORY] STRING # To identify the ControlName, please refer to the 'ControlName' field in the '/catalog/globalcatalog/rules/ProcessFindingsFromSecurityHub/ControlConfig.json' file. 
    - ControlConfigFile: [MANDATORY] <<MINIO_FILE_PATH>>
    
2. Outputs:
    - SecurityHubReport:  <<MINIO_FILE_PATH>>
    - LogFile:  <<MINIO_FILE_PATH>>


### **InputsSection**:
    
1. SecurityHubFindingsFile (Mandatory)

    - This file contains the security-related findings from AWS Security Hub.
    - This file is the output generated by the FetchSecurityHubFindings task.

    **Note:**
    - For a sample of this file, refer to the output from the FetchSecurityHubFindings task.
        

2. ControlName (Mandatory)
    - 'ControlName' refers to the specific security control used for filtering the findings from AWS Security Hub. It helps to narrow down the findings based on a particular security rule or compliance check
    
    - Example: "EC2.6" is a security control in an AWS environment.

    
3. ControlConfigFile (Mandatory)

    - This file contains configuration data for evaluating the compliance status of a specific AWS security control or configuration requirement within an AWS environment. It tracks whether certain AWS services or security configurations (like logging, monitoring, or encryption) are correctly set up according to best practices or compliance standards.

    - The file includes:

        - ControlName: The name of the specific security control being evaluated.

        - EvidenceName: The name of the security measure or evidence being checked for compliance.

        - COMPLIANT: A section that provides details on the compliance status when the control is properly implemented. This includes:

            1. ComplianceStatusReason: A brief explanation of why the control is considered compliant.

            2. ValidationStatusCode: A code indicating the compliant status.

            3. ValidationStatusNotes: Additional details confirming that the security configuration is in place and functional.

        - NON_COMPLIANT: A section that outlines the non-compliant status when the control is missing or misconfigured. This includes:

            1. ComplianceStatusReason: A brief explanation of why the control is considered non-compliant.

            2. ValidationStatusCode: A code indicating the non-compliant status.

            3. ValidationStatusNotes: Additional details explaining why the security configuration is absent or not working.

        - NOT_DETERMINED: A section that represents the undetermined compliance status, which might occur if the system cannot verify the control’s status. This includes:

            1. ComplianceStatusReason: A reason indicating why the status couldn’t be determined.

            2. ValidationStatusCode: A placeholder code indicating that compliance could not be determined.

            3. ValidationStatusNotes: Placeholder notes explaining the undetermined status.


    - Sample data 

    ```json
    {
        "ControlName": "EC2.6",
        "EvidenceName": "VPCFlowLogsEnabled",
        "COMPLIANT": {
            "ComplianceStatusReason": "Record compliant as vpc flow logs are created",
            "ValidationStatusCode": "VPC_FLOW_LOGS_CREATED",
            "ValidationStatusNotes": "VPC flow logs are created"
        },
        "NON_COMPLIANT": {
            "ComplianceStatusReason": "Record not compliant as vpc flow logs are not created",
            "ValidationStatusCode": "VPC_FLOW_LOGS_NOT_CREATED",
            "ValidationStatusNotes": "VPC flow logs are not created"
        },
        "NOT_DETERMINED": {
            "ComplianceStatusReason": "VPC flow logs status could not be determined",
            "ValidationStatusCode": "ComplianceStatusReasons.[0].ReasonCode",
            "ValidationStatusNotes": "ComplianceStatusReasons.[0].Description"
        }
    }
    ```
        

### **OutputsSection**:

1. SecurityHubReport 
    - This file includes the findings and corresponding complaint details from the ControlConfigFile that match the specified control name.

2. LogFile
    - This file records any errors that occur during a task, helping to track and troubleshoot issues.

